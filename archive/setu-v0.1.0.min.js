!function(a,o){function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function e(e){return"object"==typeof e&&!u(e)}function t(){}function n(e){for(e in hn[e]&&(yn=hn[e]),hn)hn[e]<=yn?console[e]=console[e]||t:console[e]=t;console.group=console.group&&t!==console.info?console.group:t,console.groupEnd=console.groupEnd&&t!==console.info?console.groupEnd:t,gn=console.time&&t!==console.error?console.time:t,bn=console.timeEnd&&t!==console.error?console.timeEnd:t,console.time=console.time&&t!==console.info?console.time:t,console.timeEnd=console.timeEnd&&t!==console.info?console.timeEnd:t,En=console.info,An=console.warn,kn=console.error}function r(e){return new Date(e).toLocaleString()}function i(a,e,t,o,i){(t=t||{}).method=a||"GET",t.cache=t.cache||!1,t.beforeSend=t.beforeSend||function(e,t){p("ajax.beforeSend",e,t,this)},t.success=function(e,t,n,r){try{p("ajax.done",e,t,n,r)}catch(e){}o&&o({data:e,status:t,xhr:r,url:n})},t.error=function(e,t,n,r){kn("Setu.http ajax !",n,a,t,e);try{p("ajax.done",e,t,n,r)}catch(e){}i&&i(Error(JSON.stringify({status:t,error:e,url:n})))},$_.ajax(e,t)}function v(e,t,n,r){return i("GET",e,t,n,r)}function c(e,t,n,r){return i("POST",e,t,n,r)}function s(e,t,n,r){return i("PATCH",e,t,n,r)}function l(e,t,n,r){return i("PUT",e,t,n,r)}function f(e,t,n,r){return i("DELETE",e,t,n,r)}function d(e,t,n){Sn[e]=Sn[e]||[],Sn[e].push([n,t])}function p(e){if(!Sn[e])return[];var t=Array.prototype.slice.apply(arguments),n=[];return Sn[e].forEach(function(e){t[0]=e[0],n.push(e[1].apply(null,t))}),n}function m(e,t,n){xn[e].contains(n)||(xn[e].push(n),xn[e].push(t))}function _(e,t,n,r){Tn[e][t]=Tn[e][t]||[],Tn[e][t].contains(r)||(Tn[e][t].push(r),Tn[e][t].push(n))}function h(t,n,r){for(var e=xn[t].slice(),a=0;a<e.length;a+=2)try{e[a+1](e[a],n,r)}catch(e){En("Setu.events !",t,n,r,e.message,e.stack)}}function y(t,n,r,a){var e=Tn[t][n];if(e){e=e.slice();for(var o=0;o<e.length;o+=2)try{e[o+1](e[o],r,a)}catch(e){En("Setu.events !",t,n,r,a,e.message,e.stack)}}}function g(e,t){xn[e].remove(t,2)}function b(e,t,n){Tn[e][t].remove(n,2)}function E(e,t,n){Cn=n||{trailingSlash:!0,nameResolution:"Setu.models.NameResolutionDefault",urlPrefix:""},Ln=t||{},zn=eval(Cn.nameResolution),k(e)}function A(e){if(!jn[e])throw kn("Setu.models !",e,"not defined by application"),new TypeError(__badly_configured_msg__);return jn[e]}function k(e){for(var t in e){var n={},r=0,a=e[t];if(a.__dirty__||a.__model||a.__key)throw kn("Setu.models","restricted keywords __dirty__, __model, and __key cannot be used as model fields"),new TypeError(__badly_configured_msg__);for(var o in a){var i=a[o];if("string"==typeof i){if(!e[i])throw kn("Setu.models","model",t,"refers to",i,"model; but no specification for the latter provided"),new TypeError(__badly_configured_msg__)}else{if(!u(i))throw kn("Setu.models","model",t,"field",o,"invalid specification",i),new TypeError(__badly_configured_msg__);if(!Tt.contains(i[0]))throw kn("Setu.models","model",t,"field",o,"has an unidentified type",i[0]),new TypeError(__badly_configured_msg__);if("array"===i[0]&&i[1].match(/^[a-z]/)&&!jt.contains(i[1]))throw kn("Setu.models","model",t,"field",o,"is an array of unsupported type of elements",i[1]),new TypeError(__badly_configured_msg__);i.contains("primaryKey")&&(r++,n.primaryKey=o)}}if(1!==r)throw kn("Setu.models","model",t,"exactly one primary key needs to be specified"),new TypeError(__badly_configured_msg__);n.name=t,n.pathPrefix=Cn.urlPrefix+"/"+zn.m2p(n.name),n.spec=a,n.instanceType=w(n),jn[t]=n}}function w(e){var t={};for(var n in e.spec)t[n]={get:function(e){return function(){return this["__"+e]}}(n),set:function(n){return function(e){var t=this["__"+n];if(t!==(this["__"+n]=e)){if(!this.__created||this.__dontFireChange)return;L(this,n,t,e)}}}(n),enumerable:!0};return t}function S(e){var t=Object.create(Object.prototype,e.instanceType);for(var n in e.spec){var r=e.spec[n],a=u(r)&&"array"===r[0]?[]:o;t["__"+n]=a}return t.__model=e,t.__dirty__={},t}function x(r,e,a,t){e||(e=""),v(r.pathPrefix+(e||Cn.trailingSlash?"/":"")+(e?"?"+e:""),{format:"json"},function(e){var t=p("models.listOutput",e)[0],n=[];t.forEach(function(e){var t=S(r);j(t,e),n.push(t)}),a(n)},function(e){t&&t([])})}function T(r,e,a,t){var n=e.match(Zt),o=[n[2]||n[3],n[4]];v(r.pathPrefix+"/"+o[0]+(Cn.trailingSlash?"/":"")+(o[1]?"?"+o[1].replace(/:/,"="):""),{format:"json"},function(e){var t=e.data,n=S(r);j(n,t),a(n)},function(e){t&&t({})})}function j(e,t){if(t){var n=e.__model.spec;for(var r in t)n[r]&&(e[r]=t[r]);e.__created=!0,e.__key=e.__model.name+"|"+e[e.__model.primaryKey],ae(e)}}function L(e,t,n,r){e.__dirty__[t]=!0,y(fn,e.__key,e,{field:t,oldVal:n,newVal:r})}function C(e,t){var n=Ln[e.__model.name];return n&&n[t]?n[t](e):o}function z(e,t,n){return e.__created?Z(e,t,n):O(e,t,n)}function O(n,r,t){if(n.__created)return kn("Setu.instances","internal programming error or user forced create of an already created instance",n),void r(n);var e=n.__model.pathPrefix+(Cn.trailingSlash?"/":"");n.__queryparams&&(e+="?"+n.__queryparams,delete n.__queryparams);var a={};for(var o in n.__model.spec)"string"!=typeof n.__model.spec[o]&&n.__model.spec[o].contains("auto")||(a[o]=n[o]);c(e,{data:a,contentType:wt,format:"json"},function(e){var t=e.data;j(n,t),y(dn,n.__model.name,n),r(n)},function(e){t&&t({})})}function Z(r,a,t){if(!r.__created)return kn("Setu.instances","internal programming error or user forced update of an instance that does not exist in backend",r),void a(r);var e=r.__model.pathPrefix+"/"+r[r.__model.primaryKey]+(Cn.trailingSlash?"/":"");r.__queryparams&&(e+="?"+r.__queryparams,delete r.__queryparams);var n={};for(var o in r.__dirty__)n[o]=r[o];s(e,{data:n,contentType:wt},function(e){var t=e.data;for(var n in r.__dontFireChange=!0,t)r.__model.spec[n]&&(r[n]=t[n]);r.__dirty__={},r.__dontFireChange=!1,y(mn,r.__model.name,r),a(r)},function(e){t&&t({})})}function q(){for(var e in Zn)delete On[e];Zn={},qn=o}function R(e,t){On[e]=t,Zn[e]=!0,"event"===e&&(qn=t)}function $(e){return On[e]}function I(e){for(var t in e){var n=e[t];On[t]=n,Zn[t]=!0,"event"===t&&(qn=n)}}function P(e,t){!e.event&&qn&&On.event!==qn&&(On.event=qn),I(e);var n=t.replace(qt,function(t){var e=t.replace(/[{}]/g,"").replace(/\s*\|\s*/,"|");parts=e.split("|");try{var n=eval(parts[0]);if(o===n)return t;for(var r=1;r<parts.length;++r){var a=parts[r];if(n=wn[a]?wn[a](n):n[eval(a)],o===n)return t}return n}catch(e){return t}});return D(Object.keys(e)),n}function M(e,t){var n;!e.event&&qn&&On.event!==qn&&(On.event=qn),I(e);try{n=t.match(qt)?eval(P({},t)):eval(t)}catch(e){return t}return D(Object.keys(e)),n}function D(e){e.forEach(function(e){On[e]&&(On[e]=o),Zn[e]=o,"event"===e&&(qn=o)})}function H(e){e.registered||(_(dn,e.model.name,F,e),_(mn,e.model.name,K,e),_(pn,e.model.name,B,e),e.registered=!0)}function N(e){e.registered&&(b(dn,e.model.name,e),b(mn,e.model.name,e),b(pn,e.model.name,e),e.registered=!1)}function F(e,t){U(e,t)&&Q(e,t)}function K(e,t){var n=U(e,t),r=e.value.contains(t);n&&!r?Q(e,t,!0):!n&&r&&G(e,t,!0)}function B(e,t){e.value.contains(t)&&G(e,t)}function U(e,t){if(e.params)for(var n in e.params)if(t[n]){if(e.params[n]!=t[n])return!1}else if(e.params[n]!=C(t,n))return!1;return!0}function Q(e,t,n){e.value.unshift(t),1<e.value.length?n?vt():y(un,e.key,e):n?vt():h(on,e)}function G(e,t,n){e.value.remove(t),n?vt():y(un,e.key,e)}function V(e){e.registered||(_(fn,e.value.__key,X,e),_(pn,e.value.__key,W,e),e.registered=!0)}function J(e){e.registered&&(b(fn,e.value.__key,e),b(pn,e.value.__key,e),e.registered=!1)}function X(e,t,n){n.key=e.key,y(cn,e.key,e,n)}function W(e){}function Y(e){$n=e,Rn={}}function ee(e){if(!e||!e.length)return!1;var r={};return e.every(function(e){var t,n=e.title;return(t=Rn[e.key])&&t.value?(r[n]=t.value,!0):r=!1}),r}function te(r,a,o){if(r&&r.length){var i={};r.forEach(function(e){var t="string"==typeof e?ce(a,e):e,n=t.title;Rn[t.key]?t=Rn[t.key]:Rn[t.key]=t,se(n,t,function(e){i[e.title]=e.value,Object.keys(i).length===r.length&&o(i)})})}else o({})}function ne(e){Rn[e]&&(ue(Rn[e]),delete Rn[e])}function re(){for(var e in Rn)ue(Rn[e]),delete Rn[e]}function ae(e){if(!Rn[e.__key]){var t={type:en,key:e.__key,title:zn.m2i(e.__model.name),model:e.__model,pk:e[e.__model.primaryKey],value:e};V(t),Rn[e.__key]=t}}function oe(e,t){var n,r;if(t.match(qt))try{t=P(e,t)}catch(e){}if(!(n=(r=t.match(Ct))?{title:r[1],model:A(r[2]),params:r[3],key:r[2]+"|"+r[3]}:(r=t.match(Ot))?{title:r[1],model:A(r[2]),key:r[2]}:(r=t.match(zt))?{title:t,model:A(r[1]),params:r[2],key:t}:{title:t,model:A(t),key:t}).params||n.params.match(/=/))n.type=Yt,n.title===t&&(n.title=zn.m2l(n.model.name));else{if(!n.params)throw kn("Setu.resources !","invalid instance key",t),new TypeError(__invalid_meta_msg__);n.type=en,n.title===t&&(n.title=zn.m2i(n.model.name)),n.pk=n.params,n.params=o}return n}function ie(e){return Yt===e.type?zn.m2l(e.model.name):en===e.type?zn.m2i(e.model.name):o}function ue(e){Yt===e.type?N(e):en===e.type&&J(e)}function ce(e,t){var n=$n[t];if(n)return{type:"api",key:t,title:t,api:n};var r=oe(e,t);if(Yt===r.type&&r.params){r.queryparams=r.params.replace(/;/,"&");var a=r.params.split(";");r.params={},a.forEach(function(e){var t=e.split("=");r.params[t[0]]=t[1]})}return r}function se(t,n,r){switch(n.type){case Yt:n.value?r({title:t,value:n.value}):x(n.model,n.queryparams,function(e){n.value=e,H(n),r({title:t,value:n.value})},function(e){r({title:t,value:e})});break;case en:n.value?r({title:t,value:n.value}):T(n.model,n.pk,function(e){n.value=e,V(n),r({title:t,value:n.value})},function(e){r({title:t,value:e})});break;case"api":n.value?r({title:t,value:n.value}):v(n.api,{format:"json"},function(e){n.value=e.data,r({title:t,value:n.value})},function(e){r({title:t,value:o})})}}function le(e){return de(e)||fe(e)||e.querySelectorAll(vn).length}function fe(e){return e.outerHTML&&e.outerHTML.match(qt)}function de(e){for(var t=0;t<Wt.length;++t)if(e.hasAttribute(Wt[t]))return!0;return!1}function pe(e){var t,n=e.getAttribute(Ht);return n?-1!==[en,nn].indexOf(n)?{type:n}:(t=n.match(Pt))?{type:Yt,modelName:t[2]||t[6],filter:t[3]||t[7]}:(t=n.match(Mt))?{type:tn,modelName:t[2]}:{type:"generic",code:n}:null}function me(e){if(e.hasAttribute(Qt))return{type:rn,model:A(e.getAttribute(Qt))};if(e.hasAttribute(Bt)){var t=e.getAttribute(Bt),n=ce(e.setu.needed,t);if(en!==n.type)throw kn("Setu.meta !","invalid instance key",t,e),new TypeError(__invalid_meta_msg__);return{type:an,resource:n}}return null}function _e(e){return he(e,Dt)}function ve(e){return he(e,Vt)}function he(e,t){if(!e.hasAttribute(t))return[];for(var n=e.getAttribute(t).split(","),r=0;r<n.length;++r){var a=ce(e.setu.needed,n[r]);if(Yt!==a.type&&en!==a.type)throw kn("Setu.meta !","invalid key",t,n[r],e),new TypeError(__invalid_meta_msg__);n[r]=a}return n}function ye(e,t){var n=document.createElement(e.parentElement.tagName);n.innerHTML=t,e.parentElement.insertBefore(n.firstElementChild,e),n.remove();var r=e.setu;return(e=e.previousElementSibling).setu=r,Ae(e.nextElementSibling),e.setu.parent&&e.setu.parent.children.push(e),e}function ge(e,t){if(e.setu.needed[e.setu.contextKey]=t,e.outerHTML.match(qt)){var n=document.createElement(e.parentElement.tagName);n.innerHTML=P(e.setu.needed,e.outerHTML),e.parentElement.insertBefore(n.firstElementChild,e),n.remove()}else e.parentElement.insertBefore(e.cloneNode(!0),e);var r=e.previousElementSibling;return r.removeAttribute(Ut),Te(e,r),r}function be(e){var t=e.setu;if(!t)throw new Error(__internal_error_msg__);var n=document.createElement(e.parentElement.tagName);n.innerHTML=P(t.needed,t.template),e.parentElement.insertBefore(n.firstElementChild,e),n.remove();var r=e.previousElementSibling;return e.classList.forEach(function(e){r.classList.add(e)}),Te(e,r),r}function Ee(e){e.setu=e.setu||{},e.setu.key=In,++In}function Ae(e){var t=e.setu;t.children&&t.children.length&&(t.children.slice().forEach(function(e){Ae(e)}),delete t.children);t.parent&&(t.parent.setu.children.remove(e),delete t.parent),y(ln,t.key,e),e.remove()}function ke(e){e.forEach(function(e){e.setu?Ae(e):e.remove()})}function we(e,t){t.setuEvalingParent=!1,t.setu=t.setu||{},t.setu.needed=t.setu.needed||{};var n=e.setu.needed,r=t.setu.needed;for(var a in n)r[a]=n[a];t.setu.contextKey=e.setu.contextKey,t.setu.parent=e}function Se(e){var t={};return t.parent=e.parentElement,t.index=$_(e).index(),t.data=e.outerHTML,t.setu=e.setu,Ae(e),t}function xe(e){if(null!==e.parent.parentElement){0<e.index?$_(e.parent).nthChild(e.index-1).after(e.data):$_(e.parent).prepend(e.data);var t=$_(e.parent).nthChild(e.index).element;t.setu=e.setu;for(var n=t.parentElement;n&&!n.setu;)n=n.parentElement;return n&&(n.setu.children=n.setu.children||[],n.setu.children.push(t),t.setu.parent=n),t}}function Te(e,t){var n=t.setu={needed:{}},r=e.setu;for(var a in r)if("needed"===a)for(var o in r.needed)n.needed[o]=r.needed[o];else"children"!==a&&(n[a]=r[a]);r.parent&&r.parent.setu.children.push(t)}function je(){Pn=[],Nn=Hn=0,Fn=Dn=!(Mn=[])}function Le(){if(!Dn)if(Mn.length){Dn=!0,Nn&&--Nn;for(var e=Mn.shift();e;)e.setuQueued=!1,Oe(e),e=Mn.shift();Hn||Nn?Dn=!1:(Dn=!1,h("MetaRender",a),Ce())}else Hn||Nn||Ce()}function Ce(){Fn||(Fn=!0,Ne(),h("PageRender",a))}function ze(e){var t=new RegExp("[^a-zA-Z0-9_]"+e+"[^a-zA-Z0-9_]",""),n=[],r=[];return Pn.forEach(function(e){e.data&&e.data.match(t)?n.push(xe(e)):r.push(e)}),Pn=r,n}function Oe(n){if(null!==n.parentNode&&!n.setuEvalingParent){var e=Array.prototype.slice.call(n.querySelectorAll(vn));e.forEach(function(e){e.setuEvalingParent=!0});var t,r=n.setu=n.setu||{};if(r.needed=r.needed||{},n.hasAttribute(Kt))return++Hn,void v(n.getAttribute(Kt),{},function(e){--Hn,n.hasAttribute(Jt)?n=e.data.match(qt)?ye(n,P(n.setu.needed,e.data)):ye(n,e.data):(e.data.match(qt)?n.innerHTML=P(n.setu.needed,e.data):n.innerHTML=e.data,n.removeAttribute(Kt),le(n)&&(Mn.push(n),n.setuQueued=!0),Le())});if(n.hasAttribute(Vt)&&!r.doneRequire){var a,o=ve(n);if(!(a=ee(o)))return++Hn,void te(o,{},function(e){for(var t in e)r.needed[t]=e[t];r.doneRequire=!0,Mn.push(n),n.setuQueued=!0,--Hn,Le()});for(var i in a)r.needed[i]=a[i];r.doneRequire=!0}if(n.hasAttribute(Dt)&&!n.setu.template)if(n.hasAttribute(Ut)){var u=n.getAttribute(Ut);n.removeAttribute(Ut),r.template=n.outerHTML,n.setAttribute(Ut,u)}else r.template=n.outerHTML;if(n.hasAttribute(Ut)&&(t=n.getAttribute(Ut).match($t))){var c=t[1],s=t[2];try{s=M(r.needed,s)}catch(e){return}return n.setu.contextKey=c,s.forEach(function(e){ge(n,e)}),s.length&&le(n.previousElementSibling)&&(Nn=1),ke(e),void Ae(n)}if(n.hasAttribute(Ft)){var l=n.getAttribute(Ft),f=!1;try{f=M(r.needed,l)}catch(e){return}if(!f)return void Pn.push(Se(n))}if(n.hasAttribute(Nt)&&(t=n.getAttribute(Nt).match(It))){var d=t[1],p=t[2];try{p=M(r.needed,p)}catch(e){return}r.needed[d]=p}if(n.outerHTML.match(qt)){I(r.needed),n.innerHTML.match(qt)&&(ot(),n.innerHTML=P({},n.innerHTML),ke(e),at(),e=Array.prototype.slice.call(n.querySelectorAll(vn)));for(var m=0;m<n.attributes.length;++m){var _=n.attributes[m];_.value.match(qt)&&(_.value=P({},_.value))}D(Object.keys(r.needed))}Ee(n),e.forEach(function(e){we(n,e),e.setuQueued||(Mn.push(e),e.setuQueued=!0)}),e.length&&(r.children=e),n.hasAttribute(Ht)&&ct(n),"form"===n.tagName.toLowerCase()&&Ze(n),n.hasAttribute(Dt)&&Be(n)}}function Ze(e){null!==e.parentNode&&(e.setuForm||m("MetaRender",function(t){g("MetaRender",t),t.querySelectorAll("select").forEach(function(e){var t=e.querySelector("option[selected]");t&&(e.value=t.value)});var e=me(t);if(e)switch(e.type){case rn:qe(t,S(e.model));break;case an:var n;t=t;(n=ee([e.resource]))?qe(t,n[Object.keys(n)[0]]):te([e.resource],{},function(e){qe(t,e[Object.keys(e)[0]])})}},e))}function qe(e,t){e.setuInstance=t,Re(e),e.setuForm=!0}function Re(a){a.onsubmit=function(){if(a.hasAttribute("foreign-key"))return!1;try{var e=!0;$e(a)||(e=!1);for(var t=document.querySelectorAll('form[foreign-key="'+a.getAttribute("name")+'"]'),n=0;n<t.length;++n)$e(t[n])||(e=!1);if(!e)return!1;Ie(a),t.length&&Pe(a,t[0].getAttribute("related-as"));for(n=0;n<t.length;++n){var r=t[n];Ie(r),Me(r,a)}return a.hasAttribute(Xt)&&(a.setuInstance.__queryparams=a.getAttribute(Xt)),z(a.setuInstance,function(e){De(a,t),h("FormSuccess",a,e)},function(e){De(a,t),kn("Setu.post-meta ! form-submit",a)}),!1}catch(e){return En("Setu.post-meta form-submit",e.message,e.stack),!1}}}function $e(e){return-1===p("form.validation",e).indexOf(!1)}function Ie(e){for(var t=e.elements,n=0;n<t.length;++n){var r=t[n];-1===["submit","reset"].indexOf(r.getAttribute("type"))&&r.getAttribute("name")&&(e.setuInstance[r.getAttribute("name")]=r.value)}p("form.fixupInstance",e,e.setuInstance)}function Pe(e,t){var n=e.setuInstance.__model.spec[t],r=e.setuInstance;u(n)&&"array"===n[0]?r[t]=[]:r[t]=o}function Me(e,t){var n=e.getAttribute("related-as"),r=t.setuInstance.__model.spec[n],a=e.setuInstance,o={};for(var i in a.__model.spec)"string"!=typeof a.__model.spec[i]&&a.__model.spec[i].contains("auto")||(o[i]=a[i]);u(r)&&"array"===r[0]?t.setuInstance[n].push(o):t.setuInstance[n]=o}function De(e,t){if(e.hasAttribute(Qt)){He(e);for(var n=0;n<t.length;++n){var r=t[n];r.hasAttribute(Qt)&&He(r)}}}function He(e){e.setuInstance=S(e.setuInstance.__model)}function Ne(){Fe()}function Fe(){er.querySelectorAll("a[href]").forEach(function(t){if(t.setuLink)return!0;var e=t.getAttribute("href").replace(/\?.*$/,"");Qn[e]&&$_(t).onclick(function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),ht(t.getAttribute("href")),!1}),t.setuLink=!0})}function Ke(){Kn={},Un=!(Bn=[])}function Be(n){if(n.setuBind)return!0;var r=n.setu;r?(_e(n).forEach(function(e){var t=e.key;Kn[t]=Kn[t]||{},Kn[t][r.key]||(Kn[t][r.key]=n,1===Object.keys(Kn[t]).length&&(en===e.type?_(cn,t,Qe,a):Yt===e.type&&_(un,t,Ve,a)))}),_(ln,r.key,Ue,a),n.setuBind=!0):kn("Setu.binds","internal programming error with binds",n)}function Ue(e,t){var n=t.setu;_e(t).forEach(function(e){var t=e.key;Kn[t][n.key]&&(delete Kn[t][n.key],0===Object.keys(Kn[t]).length&&(en===e.type?b(cn,t,a):Yt===e.type&&b(un,t,a)))}),b(ln,n.key,a)}function Qe(e,t,n){if(!Xe(Qe,e,t,n)){var r=n.key,a=n.field;if(Kn[r]){var o=Kn[r]?Object.keys(Kn[r]).slice():[],i=[];o.forEach(function(e){var t=Kn[r][e],n=new RegExp("\\."+a+"[^a-zA-Z0-9_]","g");t.setu.template.match(n)&&i.push(e)}),i.length&&Je(r,i),We()}else We()}}function Ge(e,t){var n=t.key,r=Kn[n]?Object.keys(Kn[n]).slice():[];r.length?Je(n,r):ze(t.title||ie(t))}function Ve(e,t){var n=t.key;Kn[n]&&Je(n,Kn[n]?Object.keys(Kn[n]).slice():[])}function Je(n,e){e.forEach(function(e){var t=Kn[n][e];be(t),Ae(t)})}function Xe(e,t,n,r){return Un?(Bn.push([e,t,n,r]),!0):!(Un=!0)}function We(){Un=!1;var e=Bn.shift();e&&e[0](e[1],e[2],e[3])}function Ye(e){Qn=e,tt()}function et(t){if(Jn&&Jn.path?(Vn=Jn.path.replace(/\?.*$/,""),Jn=null):Vn=location.pathname,!Qn[Vn])return Gn={},void t();var e=Qn[Vn];"function"==typeof e?e(function(e){Gn=e,t()}):(Gn=e,t())}function tt(){Gn=Vn=o}function nt(e){history.pushState({path:e},"",e)}function rt(e){history.replaceState({path:e},"",e)}function at(){er&&er.parentNode&&Xn.observe(er,{childList:!0,subtree:!0})}function ot(){Xn.disconnect()}function it(e){var r=!1;e.forEach(function(e){if(e.addedNodes&&e.addedNodes.length)for(var t=0;t<e.addedNodes.length;++t){var n=e.addedNodes[t];St==n.nodeType&&le(n)&&(Mn.push(n),n.setuQueued=!0,r=!0)}}),!Dn&&r&&Le()}function ut(e){Wn=e}function ct(e){if(!e.setuClick){var t=pe(e);if(null===t)throw kn("Setu.views ! invalid setu-click",e.getAttribute(Ht),e),new Error(__invalid_meta_msg__);switch(t.type){case en:case nn:st(e,t);break;case tn:case Yt:lt(e,t);break;case"generic":e.onclick=function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),eval(t.code)},e.setuClick=!0}}}function st(e,t){var n=e.setu;if(n){var r=n.needed[n.contextKey];if(!r)throw kn("Setu.views ! setu-click specified on an element for which no instance context can be found",e),new Error(__invalid_meta_msg__);var a=r.__model.name;if(Wn[a]&&Wn[a][t.type]){var o=ft(e,a,t);t.instance=r,dt(e,t,o)}}else kn("Setu.views ! internal programming error blocked processing setu-click",e)}function lt(e,t){var n=t.modelName;Wn[n]&&Wn[n][t.type]&&dt(e,t,ft(e,n,t))}function ft(e,t,n){var r=Wn[t][n.type];if("function"!=typeof r)throw kn("Setu.views ! not a view function",t,n.type,r),new Error(__badly_configured_msg__);return n.passed=e.getAttribute(Gt),n.origin=e,r}function dt(e,t,n){$_(e).onclick(function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),n(t)}),e.setuClick=!0}function pt(e){(Yn=e).logLevel&&n(Yn.logLevel),Yn.adapters&&Yn.adapters.forEach(function(e){a.adapters[e].forEach(function(e){d(e.purpose,e.handler)})})}function mt(){return Yn.pathchange&&Yn.pathchange.flush?Yn.pathchange.flush:o}function _t(e,t){nr=e,pt(t.config||{}),Ye(t.routes||{}),E(t.models,t.modelFilters,t.config&&t.config.models),Y(t.resources||{}),ut(t.views||{}),gt()}function vt(){kt(),gt()}function ht(e){nt(e),gt()}function yt(e){rt(e),gt()}function gt(){bt(),h("PageBegin",a),Et()}function bt(){var e=mt();for(var t in e)switch(t){case"resources":e[t].forEach(function(e){ne(e)})}if(tt(),je(),Ke(),q(),tr){for(var n=tr.previousElementSibling;n;){var r=n;n=n.previousElementSibling,r.remove()}tr=o}}function Et(){et(function(){if(Gn.redirect)yt(Gn.redirect);else if(Gn.include){var n={};if(location.search)location.search.replace(/^\?/,"").split("&").forEach(function(e){var t=e.split("=");n[decodeURIComponent(t[0])]=decodeURIComponent(t[1])});R("queryparams",n),Gn.flush&&kt(),te(Gn.require||[],{},function(e){I(e),at(),At()})}else at(),er.querySelectorAll(vn).forEach(function(e){Mn.push(e),e.setuQueued=!0}),Le()})}function At(){v(Gn.include,{},function(e){(tr=er.firstElementChild)?$_(tr).before(e.data):$_(er).append(e.data),er.querySelectorAll(vn).length||Ce()})}function kt(){re()}var wt="application/json; charset=UTF-8",St=1,xt=8,Tt=["string","uuid","integer","decimal","datetime","boolean","array"],jt=["string","uuid","integer","decimal","datetime","boolean"],Lt=["Uuid","Integer","Object"],Ct=/^{([a-z][0-9a-zA-Z_]+)}([A-Za-z][0-9a-zA-Z_]+)\|(.*)$/,zt=/^([A-Za-z][0-9a-zA-Z_]+)\|(.*)$/,Ot=/^{([a-z][0-9a-zA-Z_]+)}([A-Za-z][0-9a-zA-Z_]+)$/,Zt=/(^([^\?]+)$|^([^\?]+)\?(.*)$)/,qt=/({{[^{}]+}})/g,Rt=/^setu\-([a-z])([a-z]+)$/,$t=/([a-zA-Z][a-zA-Z0-9_\.]*)[\s]*in[\s]*([a-zA-Z][a-zA-Z0-9_\.]+)/,It=/([a-zA-Z][a-zA-Z0-9_]*)[\s]*=[\s]*(.*)+/,Pt=/(^(list):([A-Z][A-Za-z0-9_]+)$)|(^(list):([A-Z][A-Za-z0-9_]+)\|(.*)$)/,Mt=/^(create):([A-Z][A-Za-z0-9_]+)$/,Dt="setu-bind",Ht="setu-click",Nt="setu-declare",Ft="setu-if",Kt="setu-include",Bt="setu-instance",Ut="setu-loop",Qt="setu-model",Gt="setu-pass",Vt="setu-require",Jt="setu-replace",Xt="setu-params",Wt=[Dt,Ht,Nt,Ft,Kt,Bt,Ut,Qt,Gt,Vt],Yt="list",en="detail",tn="create",nn="update",rn="model",an="instance",on="ListResourceCreate",un="ListResourceChange",cn="DetailResourceChange",sn="DetailResourceDelete",ln="BeforeElementDelete",fn="InstanceChange",dn="InstanceCreate",pn="InstanceDelete",mn="InstanceSave";__badly_configured_msg__="Improperly configured Setu application",__invalid_meta_msg__="Invalid Setu meta syntax",__internal_error_msg__="Setu internal error";var _n=[];Wt.forEach(function(e){_n.push("["+e+"]")});var vn=_n.join(",");Array.prototype.contains=function(e){return-1!==this.indexOf(e)},Array.prototype.remove=function(e,t){var n;-1!==(n=this.indexOf(e))&&this.splice(n,t||1)};var hn={error:1,warn:2,info:3,log:4,debug:5},yn=5;console.debug=console.debug||t,console.log=console.log||t,console.group=console.group||t,console.groupEnd=console.groupEnd||t,console.time=console.time||t,console.timeEnd=console.timeEnd||t;var gn=console.time||t,bn=console.timeEnd||t,En=console.info||t,An=console.warn||t,kn=console.error||t,wn={datetime:r},Sn={};a.adapters={};var xn={},Tn={};xn[on]=[],xn.FormSuccess=[],xn.PageRender=[],xn.MetaRender=[],xn.PageBegin=[],Tn[ln]={},Tn[cn]={},Tn[fn]={},Tn[dn]={},Tn[pn]={},Tn[mn]={},Tn[un]={},a.register=m,a.unregister=g,a.models={},a.models.NameResolutionDefault={m2p:function(e){return e.replace(/^([A-Z])/,function(e){return e.toLowerCase()}).replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})+"s"},p2m:function(e){return e.replace(/^([a-z])/,function(e){return e.toUpperCase()}).replace(/(-[a-z])/g,function(e){return e.charAt(1).toUpperCase()}).replace(/s$/,"")},m2i:function(e){return e.replace(/^([A-Z])/,function(e){return e.toLowerCase()}).replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})},i2m:function(e){return e.replace(/^([a-z])/,function(e){return e.toUpperCase()}).replace(/(_[a-z])/g,function(e){return e.charAt(1).toUpperCase()})},m2l:function(e){return this.m2i(e)+"s"},l2m:function(e){return this.i2m(e).replace(/s$/,"")}};var jn={},Ln,Cn,zn,On=window,Zn={},qn,Rn,$n;a.set=R,a.get=te;var In=1e4,Pn=[],Mn=[],Dn=!1,Hn=0,Nn=0,Fn=!1,Kn={},Bn=[],Un=!1,Qn,Gn,Vn,Jn;m(on,Ge),history.pushState({path:location.pathname+location.search},"",location.pathname+location.search),window.onpopstate=function(e){e.state&&e.state.path&&(Jn=e.state,gt())};var Xn=new MutationObserver(function(e){it(e)}),Wn,Yn,er=document.querySelector("[setu-app]"),tr,nr;if(!er)throw new TypeError(__badly_configured_msg__);a.run=_t,a.refresh=vt,a.open=ht,a.clear=function(){je()},a.app=er}(window.Setu=window.Setu||{}),$_.ready(function(){Setu.adapters.Django=[{purpose:"ajax.beforeSend",handler:function(e,t,n,r){if(!/^(GET|HEAD|OPTIONS|TRACE)$/.test(n.method)&&!r.crossDomain){var a=document.cookie.match(new RegExp("csrftoken=([^;]+)"));a&&t.setRequestHeader("X-CSRFToken",a[1])}}}]}),$_.ready(function(){Setu.adapters.DjangoRestFramework=[{purpose:"models.listOutput",handler:function(e,t){function n(e){return"[object Array]"===Object.prototype.toString.call(e)}var r,a=t.data;return"object"!=typeof(r=a)||n(r)?n(a)?a:void 0:(window.SetuExtras=window.SetuExtras||{},window.SetuExtras.paginationData={available:a.count,next:a.next,previous:a.previous},a.results)}}]});